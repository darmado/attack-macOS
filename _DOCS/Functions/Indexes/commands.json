{
  "type": "bundle",
  "id": "bundle--f81d4fae-7dec-11d0-a765-00a0c91e6bf6",
  "spec_version": "2.1",
  "objects": [
    {
      "type": "attack-pattern",
      "id": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475",
      "created": "2024-03-14T12:34:56.789Z",
      "modified": "2024-03-14T12:34:56.789Z",
      "name": "Account Discovery: Local Account",
      "description": "Adversaries may attempt to get a listing of local system accounts.",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "discovery"
        }
      ],
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1087/001",
          "external_id": "T1087.001"
        }
      ],
      "x_mitre_platforms": [
        "macOS"
      ],
      "x_mitre_detection": "Monitor command-line activity for commands that could be used to gather local account information.",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "Process: Process Creation"
      ],
      "x_mitre_commands": [
        {
          "source_name": "accounts.sh",
          "description": "List user directories",
          "command": "ls -la /Users"
        },
        {
          "source_name": "accounts.sh",
          "description": "Enumerate local user accounts",
          "command": "dscl . -list /Users"
        },
        {
          "source_name": "accounts.sh",
          "description": "Display passwd file content",
          "command": "cat /etc/passwd"
        },
        {
          "source_name": "accounts.sh",
          "description": "Show current user's ID and groups",
          "command": "id"
        },
        {
          "source_name": "accounts.sh",
          "description": "List logged-in users",
          "command": "who"
        },
        {
          "source_name": "accounts.sh",
          "description": "Read login window preferences",
          "command": "defaults read /Library/Preferences/com.apple.loginwindow"
        },
        {
          "source_name": "accounts.sh",
          "description": "Query user information",
          "command": "dscacheutil -q user"
        },
        {
          "source_name": "accounts.sh",
          "description": "Query group information",
          "command": "dscacheutil -q group"
        },
        {
          "source_name": "accounts.sh",
          "description": "List local groups",
          "command": "dscl . -list /Groups"
        },
        {
          "source_name": "accounts.sh",
          "description": "Search group file",
          "command": "grep /etc/group"
        },
        {
          "source_name": "accounts.sh",
          "description": "Display current user's group IDs",
          "command": "id -G"
        },
        {
          "source_name": "accounts.sh",
          "description": "Show current user's group memberships",
          "command": "groups"
        }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c",
      "created": "2024-03-14T12:34:56.789Z",
      "modified": "2024-03-14T12:34:56.789Z",
      "name": "Credentials from Password Stores: Keychain",
      "description": "Adversaries may attempt to extract credentials from password stores such as the macOS Keychain.",
      "kill_chain_phases": [
        {
          "kill_chain_name": "mitre-attack",
          "phase_name": "credential-access"
        }
      ],
      "external_references": [
        {
          "source_name": "mitre-attack",
          "url": "https://attack.mitre.org/techniques/T1555/001",
          "external_id": "T1555.001"
        }
      ],
      "x_mitre_platforms": [
        "macOS"
      ],
      "x_mitre_detection": "Monitor for suspicious access to the Keychain or attempts to dump its contents.",
      "x_mitre_data_sources": [
        "Command: Command Execution",
        "Process: Process Creation"
      ],
      "x_mitre_commands": [
        {
          "source_name": "keychain.sh",
          "description": "Dump login keychain contents",
          "command": "security dump-keychain login.keychain"
        },
        {
          "source_name": "keychain.sh",
          "description": "Find generic password",
          "command": "security find-generic-password -a \"$ACCOUNT\" -s \"$SERVICE\""
        },
        {
          "source_name": "keychain.sh",
          "description": "Find internet password",
          "command": "security find-internet-password -a \"$ACCOUNT\" -s \"$SERVER\""
        },
        {
          "source_name": "keychain.sh",
          "description": "Find and print certificates",
          "command": "security find-certificate -a -p"
        },
        {
          "source_name": "keychain.sh",
          "description": "Unlock login keychain",
          "command": "security unlock-keychain login.keychain"
        },
        {
          "source_name": "keychain.sh",
          "description": "Export certificates in PEM format",
          "command": "security export -k login.keychain -t certs -f pem -o \"$OUTPUT_FILE\""
        },
        {
          "source_name": "keychain.sh",
          "description": "Find code signing identities",
          "command": "security find-identity -v -p codesigning"
        },
        {
          "source_name": "keychain.sh",
          "description": "Extract readable strings from keychain",
          "command": "strings ~/Library/Keychains/login.keychain-db"
        },
        {
          "source_name": "keychain.sh",
          "description": "Dump entire keychain database",
          "command": "sqlite3 ~/Library/Keychains/login.keychain-db .dump"
        }
      ]
    }
  ]
}
